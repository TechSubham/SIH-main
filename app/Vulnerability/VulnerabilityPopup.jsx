
import React from "react";
import { AlertCircle, ExternalLink } from 'lucide-react';
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
  DialogDescription,
} from "@/components/ui/dialog";

const VulnerabilityPopup = ({ vulnerability, isOpen, onClose }) => {
  const getSeverityClass = (severity) => {
    switch (severity?.toLowerCase()) {
      case "important": return "bg-red-100 text-red-800";
      case "moderate": return "bg-yellow-100 text-yellow-800";
      case "high": return "bg-purple-100 text-purple-800";
      case "medium": return "bg-green-100 text-green-800";
      case "critical": return "bg-red-100 text-red-800";
      default: return "bg-gray-200 text-gray-800";
    }
  };

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="sm:max-w-[600px] max-h-[80vh] overflow-y-auto">
        <DialogHeader className="flex flex-col items-center">
          <AlertCircle className="w-16 h-16 text-red-500 mb-4" />
          <DialogTitle
            className={`text-xl font-semibold mb-2 p-2 rounded ${getSeverityClass(vulnerability.severity)}`}
          >
            {vulnerability.severity}
          </DialogTitle>
        </DialogHeader>
        <DialogDescription className="text-left">
          <div className="space-y-4">
            <InfoItem label="CVE ID" value={vulnerability.cve_id} />
            <InfoItem label="Published Date" value={vulnerability.published_date ? new Date(vulnerability.published_date).toLocaleDateString() : 'N/A'} />
            <InfoItem label="Description" value={vulnerability.description} />
          </div>
        </DialogDescription>
      </DialogContent>
    </Dialog>
  );
};

const InfoItem = ({ label, value }) => (
  <div>
    <span className="font-semibold">{label}: </span>
    {typeof value === 'object' ? value : <span>{value || 'N/A'}</span>}
  </div>
);

export default VulnerabilityPopup;
